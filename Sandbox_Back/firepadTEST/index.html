<!DOCTYPE html>

<html>
    <head>
        <title>TEST</title>
        <!-- Firebase -->
        <script src="https://www.gstatic.com/firebasejs/5.3.1/firebase.js"></script>

        <!-- Ace -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.5/ace.js"></script>

        <!-- Firepad -->
        <link rel="stylesheet" href="https://cdn.firebase.com/libs/firepad/1.4.0/firepad.css" />
        <script src="https://cdn.firebase.com/libs/firepad/1.4.0/firepad.min.js"></script>
<!--<script src="firepad-userlist.js"></script>-->

<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
ï¿¼

        <style>
            #firepad {
                position: absolute;
left: 0;
right: 0;
top: 0;
bottom: 0;
height: 100vh;
            }
        </style>
    </head>
    <body onload="init()">

<!--  <div id="userlist"></div>-->
<button id="chRoomBtn">CHANGE</button>
        <div id="firepad"></div>

        <script>
function getParameterByName(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[\[\]]/g, '\\$&');
    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, ' '));
}
function init() {
            // Initialize Firebase
            var config = {
                apiKey: "AIzaSyBQgPQC1Zzky-8zJbFAO_8bkA29Ycq_kG4",
                authDomain: "sandbox-9291d.firebaseapp.com",
                databaseURL: "https://sandbox-9291d.firebaseio.com",
                projectId: "sandbox-9291d",
                storageBucket: "sandbox-9291d.appspot.com",
                messagingSenderId: "177612955416"
            };
            firebase.initializeApp(config);

            var firepadRef = firebase.database().ref(getParameterByName("id"));
            var editor = ace.edit('firepad');
            var firepad = Firepad.fromACE(firepadRef, editor, {userId: getParameterByName("u")});
firepadRef.on('child_added', function (userSnapshot, prevChildName) {
    console.log(userSnapshot);
console.log(prevChildName);
});
/*var firepadUserList = FirepadUserList.fromDiv(firepadRef,
          document.getElementById('userlist'), "shriggy");*/
	document.getElementById('chRoomBtn').onclick = function() {
$('.firepad').remove();
/*let firepad = $('</textarea>');
firepad.attr('id', 'firepad');
firepad.appendTo("body");*/
var $div = $('<div />').appendTo('body');
$div.attr('id', 'firepad');

firepadRef = firebase.database().ref("NEWID2");
editor = ace.edit('firepad');
firepad = Firepad.fromACE(firepadRef, editor, {userId: getParameterByName("u")});

	};
}
        </script>        
    </body>
</html>
